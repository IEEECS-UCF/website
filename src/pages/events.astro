---
import BaseLayout from "../layouts/BaseLayout.astro";
import { client } from "~/lib/sanityClient";
import EventCard from "../components/EventCard.astro";

// Fetch all events from Sanity, sorted by date descending
const events = await client.fetch(`*[_type == "event"] | order(dateTime desc)`);

const title = "Events - IEEE Computer Society @ UCF";
const description =
    "Discover upcoming events hosted by the IEEE Computer Society Student Chapter at UCF.";
---

<BaseLayout title={title} description={description}>
    <main class="container mx-auto px-4 py-12">
        <h1
            class="text-4xl font-bold mb-8 text-center text-ieee-blue dark:text-ieee-orange"
        >
            Upcoming Events
        </h1>
        <p
            class="text-lg text-center max-w-2xl mx-auto mb-10 text-gray-700 dark:text-gray-300"
        >
            Stay up to date with our latest events, workshops, and socials. All
            students are welcome!
        </p>
        <section class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
            {
                events.length > 0 ? (
                    events.map((event) => <EventCard event={event} />)
                ) : (
                    <div class="col-span-full text-center text-gray-500 text-lg py-16">
                        No events found. Please check back soon!
                    </div>
                )
            }
        </section>
        <section class="mt-16">
            <h2
                class="text-2xl font-bold mb-4 text-center text-ieee-blue dark:text-ieee-orange"
            >
                Chapter Calendar
            </h2>
            <div class="flex justify-center">
                <iframe
                    src="https://calendar.google.com/calendar/embed?src=135ddb11303dc44ee2fd38a8b888f81777d6057b058199e3770d60c67362fd60%40group.calendar.google.com&ctz=America%2FNew_York"
                    style="border: 0"
                    width="1400"
                    height="1000"
                    frameborder="0"
                    scrolling="no"></iframe>
            </div>
        </section>
        <p class="text-center text-sm text-gray-400 mt-12">
            Want to suggest an event or collaborate? <a
                href="/join"
                class="text-ieee-orange hover:underline">Join us</a
            >
            or <a
                href="mailto:ieeecs@ucf.edu"
                class="text-ieee-orange hover:underline">contact us</a
            >!
        </p>
    </main>
</BaseLayout>
